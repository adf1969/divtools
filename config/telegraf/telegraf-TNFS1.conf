# Telegraf configuration for SMART monitoring on Proxmox host TNFS1
# Edit this file in /opt/divtools/config/telegraf/ to manage via Git and VSCode
# After editing, restart Telegraf: sudo systemctl restart telegraf
# InfluxDB settings are sourced from /opt/divtools/docker/.env
# Drives are dynamically detected using lsscsi or lsblk, excluding the root device

[global_tags]
  # Host identifier for InfluxDB and Grafana
  host = "TNFS1"
  role = "proxmox"

[[outputs.influxdb_v2]]
  # InfluxDB v2 output configuration
  urls = ["http://10.1.1.104:8086"]
  token = "gfdzytp3vKUh2ctwXfA13WMqsENVP9RO_hyxuHzAd_Z3WaCA6cM2fClerPeBtgi_Uy-f_Cxp0p4bm7YpqEYCLA=="
  organization = "avc"
  bucket = "proxmox"

[[inputs.smart]]
  # Path to smartctl binary
  path_smartctl = "/usr/sbin/smartctl"
  # Drives to monitor (detected dynamically, excluding the root device)
  devices = ["/dev/sda", "/dev/sdb", "/dev/sdc", "/dev/sdd", "/dev/sde", "/dev/sdf"]
  # Enable collection of all SMART attributes (e.g., Reallocated_Sector_Ct, Temperature_Celsius)
  attributes = true
  # Collection interval (5 minutes recommended to balance granularity and I/O load)
  interval = "5m"
  # Use sudo for smartctl (requires sudoers configuration)
  use_sudo = true
