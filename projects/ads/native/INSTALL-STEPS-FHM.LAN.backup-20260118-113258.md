# Samba AD DC Installation Steps - FHM.LAN

**Generated:** 2026-01-12 17:50:29
**Domain/Realm:** FHM.LAN
**NetBIOS Name:** DOMAIN
**Admin User:** Administrator
**Host:** ads1-98

---

## Pre-Installation Checks

- [ ] System hostname set correctly
- [ ] DNS resolver configured to use this server (127.0.0.1)
- [ ] Sufficient disk space available (~2GB minimum)
- [ ] Network connectivity verified
- [ ] Internet access available for package downloads

---

## Installation Steps

### Step 1: Install Samba Packages
- [ ] Run: `apt-get update && apt-get install -y samba samba-dsdb-modules samba-vfs-modules krb5-user krb5-config winbind libpam-winbind libnss-winbind`
- [x] Verify installation: `samba-tool --version`
- [ ] Check for errors in output

### Step 2: Configure Environment Variables
- [ ] Domain Realm: `FHM.LAN`
- [ ] NetBIOS Name: `DOMAIN`
- [ ] Admin User: `Administrator`
- [ ] Domain Admin Password: (must be complex, 12+ chars)
- [ ] DNS Backend: `SAMBA_INTERNAL`

### Step 3: Provision AD Domain
- [ ] Run: `dt_ads_native.sh` → Menu Option 8: Provision AD Domain
- [ ] Wait for provisioning to complete (may take 1-2 minutes)
- [ ] Check for any error messages
- [ ] Verify /etc/samba/smb.conf was created

### Step 4: Configure DNS on Host
- [ ] Run: `dt_ads_native.sh` → Menu Option 9: Configure DNS on Host
- [ ] Stop systemd-resolved
- [ ] Update /etc/resolv.conf to point to 127.0.0.1
- [ ] Verify DNS is working: `nslookup FHM.LAN`

### Step 5: Start Samba Services
- [ ] Run: `dt_ads_native.sh` → Menu Option 10: Start Samba Services
- [ ] Verify services started: `systemctl status samba-ad-dc`
- [ ] Check Samba logs: `journalctl -u samba-ad-dc -n 20`

### Step 6: Create Soft-Links for Config Editing
- [ ] Run: `dt_ads_native.sh` → Menu Option 4: Create Config File Links
- [ ] Verify soft-links created in $DOCKER_HOSTDIR/ads.cfg/
- [ ] Test editing: Open smb.conf in VSCode

### Step 7: Install Bash Aliases
- [ ] Run: `dt_ads_native.sh` → Menu Option 5: Install Bash Aliases
- [ ] Test alias: `ads-status` or `ads-health`

### Step 8: Verify Domain Setup
- [ ] Run: `dt_ads_native.sh` → Menu Option 14: Run Health Checks
- [ ] Check all test results pass
- [ ] Verify FSMO roles assigned
- [ ] Confirm replication working

---

## Post-Installation Tasks

- [ ] Create domain admin user: `samba-tool user add <username>`
- [ ] Add user to Domain Admins group: `samba-tool group addmembers 'Domain Admins' <username>`
- [ ] Configure DNS zones (if using SAMBA_INTERNAL)
- [ ] Set up file shares (if needed)
- [ ] Configure GPOs (Group Policy Objects) as needed
- [ ] Join additional computers to the domain
- [ ] Enable regular backups of /var/lib/samba/private/

---

## Troubleshooting

If you encounter issues:

1. **DNS not resolving:** `nslookup -server=127.0.0.1 FHM.LAN`
2. **Service won't start:** `journalctl -u samba-ad-dc -p err -n 50`
3. **Replication issues:** `samba-tool drs showrepl`
4. **User authentication fails:** `kinit Administrator@FHM.LAN`

---

## Configuration Files

For detailed information about Samba configuration files, see: [N-ADS-CONFIG-FILES.md](N-ADS-CONFIG-FILES.md)

---

**Last Updated:** 2026-01-12 17:50:29
**Auto-generated by dt_ads_native.sh**
